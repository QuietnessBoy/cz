package com.zhjl.tech.channel.mvc;

import com.zhjl.tech.common.encrypt.asymmetric.SM2;
import com.zhjl.tech.common.encrypt.asymmetric.SM2Impl;
import com.zhjl.tech.common.encrypt.bytetool.Hex;

import java.security.interfaces.ECPublicKey;

public class VerifySign {


    public static void main(String[] args) {

        /**
         *
         ordersn : sebe20171012000016
         finalstring:&bizSign=d3daHIBwFva7zxGDSlTbqDFNVKZHB2NnQM4/8YaelssFNEfVD6MyKnUJUpzyrxyocxM2snjvAK5NEp+X5gWrsQ==&bizType=2&chainedCallBack=1&channelId=003&channelOrdersn=sebe20171012000016&channelUserid=sebe001&description=描述&duration=365&fileHash=vy5+Jqcv1vKBSA/9/Iz4ZNhWSgdKXdvgodGgzlT+ACs=&fileName=3261988.jpg&fileSize=30539&fileType=.jpg&ordersn=003321101256&ownerId=413025198809091122&ownerName=张三&ownerType=1&requestTime=20171011-000000&startTime=20171012-170119
         */
//        String pbyte = "2662697a5369676e3d6433646148494277467661377a784744536c54627144464e564b5a4842324e6e514d342f385961656c7373464e45665644364d794b6e554a55707a797278796f63784d32736e6a76414b354e45702b583567577273513d3d2662697a547970653d3226636861696e65643d31266368616e6e656c49643d303033266368616e6e656c4f72646572736e3d736562653230313731303132303030303136266368616e6e656c5573657269643d73656265303031266465736372697074696f6e3de68f8fe8bfb0266475726174696f6e3d3336352666696c65486173683d7679352b4a71637631764b4253412f392f497a345a4e68575367644b586476676f6447677a6c542b4143733d2666696c654e616d653d333236313938382e6a70672666696c6553697a653d33303533392666696c65547970653d2e6a7067266f72646572736e3d303033333231313031323536266f776e657249643d343133303235313938383039303931313232266f776e65724e616d653de5bca0e4b889266f776e6572547970653d31267265717565737454696d653d32303137313031312d30303030303026737461727454696d653d32303137313031322d313730313139";
//        String platformSign="4s0g1wcW80muwJAaKTDNxKnTpWIoWBKPHjpk9IfsCqDSOtWohQgqdRL8GExOJpVLA3+bNH7txpksFaCFdGLV6w==";
//        String platformIDA="zhijinlian_blockchain_cz2017";
//        String platformPublicKey="04137e4cc0e602a3315ddbfe48d77e688f52ff0dec898d14092d5cb419ac6990b526dfb25fcd83ac7f2bbb9d8fa513a11912fbf2cc453ad58ea55401f59a2e9b52"; String pbyte = "2662697a5369676e3d6433646148494277467661377a784744536c54627144464e564b5a4842324e6e514d342f385961656c7373464e45665644364d794b6e554a55707a797278796f63784d32736e6a76414b354e45702b583567577273513d3d2662697a547970653d3226636861696e65643d31266368616e6e656c49643d303033266368616e6e656c4f72646572736e3d736562653230313731303132303030303136266368616e6e656c5573657269643d73656265303031266465736372697074696f6e3de68f8fe8bfb0266475726174696f6e3d3336352666696c65486173683d7679352b4a71637631764b4253412f392f497a345a4e68575367644b586476676f6447677a6c542b4143733d2666696c654e616d653d333236313938382e6a70672666696c6553697a653d33303533392666696c65547970653d2e6a7067266f72646572736e3d303033333231313031323536266f776e657249643d343133303235313938383039303931313232266f776e65724e616d653de5bca0e4b889266f776e6572547970653d31267265717565737454696d653d32303137313031312d30303030303026737461727454696d653d32303137313031322d313730313139";

        String pbyte = "2662697a5369676e3d634d6868734c303946696365744164734f64783761742b384851553249787943425a52617758467059524a314433697a4d6874764f4e4b79334b6c5148684e4e377a6342444937696c4e544c38526e6c506647724b413d3d2662697a547970653d3126636861696e65643d31266368616e6e656c49643d303035266368616e6e656c4f72646572736e3d6f72646572736e366234633638636237266368616e6e656c5573657269643d633838266465736372697074696f6e3de68f8fe8bfb03a7b226163636573734b6579223a22326b4476384658457a623639706b3236315058505136354b657a4732667a626248583753725545596b6b61626b3734794861222c226167656e74456d61696c223a226232383938303961353161402e636f6d222c226167656e744e616d65223a226167656e746132633263222c226167656e7450686f6e65223a2234373533353631222c2262697a266475726174696f6e3d312666696c65486173683d334739734a42507a6d6c5a324f4c56752b45576e352b4a422b654862516e324b6d784b677167396e6a464d3d2666696c654e616d653d6f72646572736e3035313261303137332666696c6553697a653d3330302666696c65547970653d2e323661266f72646572736e3d303035333131313731303135303030323833266f726967696e616c4f72646572736e3d303035333131313731303135303030323636266f776e657249643d6f776e657269643131266f776e65724e616d653de69d83e5b19ee4baba31316361266f776e6572547970653d32267265717565737454696d653d32303137313031352d31383432343226737461727454696d653d32303137313031352d313834323433";
        String platformSign="";
        String platformIDA="zhijinlian_blockchain_cz2017";
        String platformPublicKey="04137e4cc0e602a3315ddbfe48d77e688f52ff0dec898d14092d5cb419ac6990b526dfb25fcd83ac7f2bbb9d8fa513a11912fbf2cc453ad58ea55401f59a2e9b52";

        //platformSign为知金链平台生成
        //platformIDA为知金链平台IDA，固定的，渠道注册时返回
        //platformPublicKey为知金链平台公钥，渠道注册时返回
        //说明：以上为拾贝测试信息

        SM2 sm2 = new SM2Impl();
        System.out.println(
                sm2.verify(Hex.decode(pbyte),
                SM2Impl.Signature.genByBase64(platformSign),
                platformIDA,
                sm2.decodePublicKey(platformPublicKey)));

    }
}
